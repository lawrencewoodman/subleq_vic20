;========================================================
;  Test SUBLEQ sble command
;  Author  Lawrence woodman <lwoodman@vlifesystems.com>
;  Date    21st June 2020
;========================================================

; Basic Stub
BSPACE    = $14               ; Backspace character
COLON     = $3A               ; Colon character
TOK_REM   = $8F               ; REM token
TOK_SYS   = $9E               ; SYS token

; TODO Check start location is appropriate

            .byt  $01, $12    ; Load address ($1201)

            * = $1201
            ; TODO get rid of basic loader as more appropriate to just SYS into
            .word basicEnd    ; Next Line link, here end of Basic program
            .word 1           ; The line number for the SYS statement
            .byt  TOK_SYS     ; SYS token
            .asc  " "
            .asc  "4662"      ; Start of machine language
            .byt  COLON       ; Colon character
            .byt  TOK_REM     ; REM token
            .asc  " "
            .dsb  15,BSPACE   ; Backspace characters to make line invisible
            .asc  "(C) 2020 LORRY WOODMAN"
            .byt  0           ; End of Basic line
basicEnd    .word 0           ; End of Basic program

            jmp main

SL_MEM      = SL_prog

; Include the SUBLEQ emulator
#include "subleq.a65"


main        jsr SL_run
            rts


SL_prog     .word 3,3,4,0,3,3,10,45,13,0
            .word 3,3,24,102,13,0,46,0,32,0
            .word 47,13,0,0,23,23,27,95,3,30
            .word 3,23,33,3,3,36,48,48,39,58
            .word 58,42,63,48,45,63,58,48,374,-1
            .word 51,814,48,54,814,58,57,815,374,64
            .word 3,3,48,-374,76,76,67,86,86,70
            .word 91,76,73,91,86,76,18,-1,79,814
            .word 76,82,814,86,85,815,18,92,3,3
            .word 76,-18,3,3,96,411,815,341,383,816
            .word 341,102,213,213,105,340,3,108,3,213
            .word 111,3,3,114,214,214,117,369,3,120
            .word 3,214,123,3,3,126,215,215,129,370
            .word 3,132,3,215,135,3,3,138,3,213
            .word 216,189,189,144,215,3,147,3,189,150
            .word 3,3,153,190,190,156,215,3,159,3
            .word 190,162,3,3,165,192,192,168,214,3
            .word 171,3,192,174,3,3,177,196,196,180
            .word 215,3,183,3,196,186,3,3,189,0
            .word 0,192,0,3,195,3,0,198,3,3
            .word 201,814,214,204,814,215,207,816,213,210
            .word 3,3,138,0,0,0,340,3,219,3
            .word 369,222,3,3,225,371,372,228,307,307
            .word 231,372,3,234,3,307,237,3,3,240
            .word 308,308,243,373,3,246,3,308,249,3
            .word 3,252,307,308,258,3,3,264,814,308
            .word 264,3,3,309,276,276,267,286,286,270
            .word 291,276,273,291,286,276,13,-1,279,814
            .word 276,282,814,286,285,815,13,292,3,3
            .word 276,-13,306,306,295,23,3,298,3,306
            .word 301,3,3,304,3,3,0,0,0,321
            .word 321,312,331,331,315,336,321,318,336,331
            .word 321,16,-1,324,814,321,327,814,331,330
            .word 815,16,337,3,3,321,-16,3,3,96
            .word 3,9,5,5,0,-1,-4,-3,-2,5
            .word 7,2,5,3,5,-2,-7,5,2,-3
            .word -1,32766,32767,-1,32767,-32768,1,-32768,32767,342
            .word 371,0,0,0,83,66,76,69,95,83
            .word 85,66,0,395,395,386,405,405,389,410
            .word 395,392,410,405,395,20,-1,398,814,395
            .word 401,814,405,404,815,20,411,3,3,395
            .word -20,23,23,414,482,3,417,3,23,420
            .word 3,3,423,435,435,426,445,445,429,450
            .word 435,432,450,445,435,771,-1,438,814,435
            .word 441,814,445,444,815,771,451,3,3,435
            .word -771,463,463,454,473,473,457,478,463,460
            .word 478,473,463,18,-1,466,814,463,469,814
            .word 473,472,815,18,479,3,3,463,-18,3
            .word 3,483,811,815,737,783,816,737,489,600
            .word 600,492,736,3,495,3,600,498,3,3
            .word 501,601,601,504,765,3,507,3,601,510
            .word 3,3,513,602,602,516,766,3,519,3
            .word 602,522,3,3,525,3,600,603,576,576
            .word 531,602,3,534,3,576,537,3,3,540
            .word 577,577,543,602,3,546,3,577,549,3
            .word 3,552,579,579,555,601,3,558,3,579
            .word 561,3,3,564,583,583,567,602,3,570
            .word 3,583,573,3,3,576,0,0,579,0
            .word 3,582,3,0,585,3,3,588,814,601
            .word 591,814,602,594,816,600,597,3,3,525
            .word 0,0,0,736,3,606,3,765,609,3
            .word 3,612,770,770,615,767,768,621,770,770
            .word 624,814,770,624,703,703,627,770,3,630
            .word 3,703,633,3,3,636,704,704,639,769
            .word 3,642,3,704,645,3,3,648,703,704
            .word 654,3,3,660,814,704,660,3,3,705
            .word 672,672,663,682,682,666,687,672,669,687
            .word 682,672,13,-1,675,814,672,678,814,682
            .word 681,815,13,688,3,3,672,-13,702,702
            .word 691,23,3,694,3,702,697,3,3,700
            .word 3,3,0,0,0,717,717,708,727,727
            .word 711,732,717,714,732,727,717,16,-1,720
            .word 814,717,723,814,727,726,815,16,733,3
            .word 3,717,-16,3,3,483,3,9,5,5
            .word 1,-1,-4,1,-2,5,0,2,5,0
            .word 5,-2,1,5,2,1,-1,32766,0,-1
            .word 32767,1,1,-32768,0,738,767,0,0,0
            .word 0,83,66,76,69,95,66,82,65,78
            .word 67,72,0,795,795,786,805,805,789,810
            .word 795,792,810,805,795,20,-1,798,814,795
            .word 801,814,805,804,815,20,811,3,3,795
            .word -20,3,3,-1,-1,0,1,10
